dem_utm=raster("G:/.shortcut-targets-by-id/15fVCtxOyan-kvhW9iOPkLv5ono_BCHpk/Lab/ELGroupPaperFall2021/Spatial Data/DEMs/1_3as/1_3asproj.tif")
#dem_utm4=raster("G:/.shortcut-targets-by-id/15fVCtxOyan-kvhW9iOPkLv5ono_BCHpk/Lab/ELGroupPaperFall2021/Spatial Data/DEMs/1m/LOC_Proj&Clipped/USGS7.tif")

#Projection change
proj4_utm = paste0("+proj=utm +zone=", 18, " +datum=WGS84 +units=m +no_defs")
proj4_ll = "+proj=longlat"; crs_ll=CRS(proj4_ll); crs_utm=CRS(proj4_utm)
dem_utm4 = projectRaster(dem_utm4,crs = crs_ll)
plot(dem_utm)
bound = Polygon(data.frame(x = c(-73.41,-73.41,-73,-73),y = c(44.35,43.9,43.9,44.35)))
bound = sp::Polygons(list(bound), ID = "A")
bound = SpatialPolygons(list(bound),proj4string = crs_ll)
lines(bound)
beep('coin')

#url=paste0("G:/.shortcut-targets-by-id/15fVCtxOyan-kvhW9iOPkLv5ono_BCHpk/Lab/ELGroupPaperFall2021/Spatial Data/Assorted Shape Files",watershedstring,"subs1.shp")
#roughboundary2 = read.shp(url)
#roughboundary2 = SpatialPoints(cbind(as.numeric(unlist(roughboundary2$shp[[1]]$points[,1])),as.numeric(unlist(roughboundary2$shp[[1]]$points[,2]))),proj4string=crs_utm)
#roughboundary2 = spTransform(roughboundary2,crs_ll)
origin(dem_utm4) = origin(dem_utm)
dem_utm = merge(dem_utm,dem_utm4)
plot(dem_utm)
points(roughboundary)
lines(bound)
beep('mario')

try = dem_utm
#extent(try)
#plot(try)
#points(roughboundary)
#bound = Polygon(data.frame(x = c(extent(try)[1],extent(try)[1],extent(try)[2],extent(try)[2]),y = c(extent(try)[3],44.145,44.145,extent(try)[3])))
#bound = sp::Polygons(list(bound), ID = "A")
#bound = SpatialPolygons(list(bound),proj4string = crs_ll)
#plot(dem_utm)
#plot(try,add = TRUE,col = rainbow(20))
#lines(bound)
#points(roughboundary)
try = mask(try,bound)
try = trim(try,values = NA)
length(values(try))/length(values(dem_utm))
#plot(dem_utm)
plot(try,col = rainbow(20))
lines(bound)
beep('coin')
writeRaster(try,"G:/.shortcut-targets-by-id/15fVCtxOyan-kvhW9iOPkLv5ono_BCHpk/Lab/ELGroupPaperFall2021/Spatial Data/DEMs/1_3as/1_3as_trim.tif")
beep('coin')
